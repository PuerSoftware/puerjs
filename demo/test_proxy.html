<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Proxy Test</title>
</head>
<body>
	<a href="/">&laquo; Home</a>
	<h1>Proxy Test</h1>
	<div id="demo"></div>
	<script>
		function createProxy(components) {
			const handler = {
				get(target, prop) {
					if (prop === Symbol.iterator) {
						return function* () {
							for (let item of components) {
								yield item;
							}
						};
					}
					
					if (prop === '$') {
						return new Proxy(components, handler);
					}
					
					if (prop === 'length') {
						return components.length;
					}
					
					if (!isNaN(Number(prop))) {
						return components[Number(prop)];
					}
					
					return components.filter(component => component.name === prop);
				},
				ownKeys(target) {
					return Object.keys(target);
				},
				getOwnPropertyDescriptor(target, prop) {
					if (prop in target) {
						return {
							enumerable: true,
							configurable: true
						};
					}
				}
			};
			
			return new Proxy(components, handler);
		}



		const components = [
			{ name: 'button', children: [] },
			{ name: 'input', children: [] },
			{ name: 'button', children: [] }
		]

		const proxy = createProxy(components)

		// Access by index
		console.log(proxy[0])  // Output: { name: 'button', children: [] }

		// Length property
		console.log(proxy.length)  // Output: 3

		// Custom property filter
		console.log(proxy['button'])  // Output: Array of buttons

		// Iteration
		for (const component of proxy) {
			console.log(component)
		}
	</script>
</body>
</html>